<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="UTF-8">
  <meta name="description" content="Web Application Development - Assignment 1">
  <meta name="keywords" content="Html, php, Mysql">
  <title>Cabs Online | Book the cab now</title>
</head>
<h1> Shop Online</h1>
<nav>
  <a href="login.html">Home</a> |
  <a href="listing.html">Listing</a> |
  <a href="bidding.html">Bidding</a> |
  <a href="maintenance.html">Maintenance</a>
  <a href="logout.html">Logout</a>
</nav>

<h1> customer for Cabs Online</h1>
<p> Please fill the form to customer</p>
<fieldset>
  Item Name*:
  <input type="text" id="itemname" name="itemname" required="required" />
  <br/> <br/>
  Category*:
  <select name="category" id="category">
    <option value="----">--Select--</option>
    <option value="camera">Camera</option>
    <option value="phone">Phone</option>
    <option value="other">Other</option>
  </select>
  <br /><br/> Description*:
  <input type="text" id="desc" name="desc" required="required" />
  <br/> <br/> Start Price*:
  <input type="text" id="startprice" name="startprice" required="required" />
  <br/> <br/> Reserve Price*:
  <input type="text" id="resprice" name="resprice" required="required" />
  <br/> <br/> Buy It Now Price*:
  <input type="text" id="buyprice" name="buyprice" required="required" />
  <br/> <br/> Duration*:
  <select name="day" id="day">
    <option selected="selected" value="">Select Day</option>
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
    <option value="5">5</option>
    <option value="6">6</option>
    <option value="7">7</option>
    <option value="8">8</option>
    <option value="9">9</option>
    <option value="10">10</option>
    <option value="11">11</option>
    <option value="12">12</option>
  </select>
  <select name="hour" id="hour">
    <option selected="selected" value="">Select Hour</option>
    <option value="00">00</option>
    <option value="01">01</option>
    <option value="02">02</option>
    <option value="03">03</option>
    <option value="04">04</option>
    <option value="05">05</option>
    <option value="06">06</option>
    <option value="07">07</option>
    <option value="08">08</option>
    <option value="09">09</option>
    <option value="10">10</option>
    <option value="11">11</option>
    <option value="12">12</option>
    <option value="13">13</option>
    <option value="14">14</option>
    <option value="15">15</option>
    <option value="16">16</option>
    <option value="17">17</option>
    <option value="18">18</option>
    <option value="19">19</option>
    <option value="20">20</option>
    <option value="21">21</option>
    <option value="22">22</option>
    <option value="23">23</option>
    <option value="24">24</option>
  </select>
  <select name="minute" id="minute">
    <option selected="selected" value="">Select Minutes</option>
    <option value="00">00</option>
    <option value="01">01</option>
    <option value="02">02</option>
    <option value="03">03</option>
    <option value="04">04</option>
    <option value="05">05</option>
    <option value="06">06</option>
    <option value="07">07</option>
    <option value="08">08</option>
    <option value="09">09</option>
    <option value="10">10</option>
    <option value="11">11</option>
    <option value="12">12</option>
    <option value="13">13</option>
    <option value="14">14</option>
    <option value="15">15</option>
    <option value="16">16</option>
    <option value="17">17</option>
    <option value="18">18</option>
    <option value="19">19</option>
    <option value="20">20</option>
    <option value="21">21</option>
    <option value="22">22</option>
    <option value="23">23</option>
    <option value="24">24</option>
    <option value="25">25</option>
    <option value="26">26</option>
    <option value="27">27</option>
    <option value="28">28</option>
    <option value="29">29</option>
    <option value="30">30</option>
    <option value="31">31</option>
    <option value="32">32</option>
    <option value="33">33</option>
    <option value="34">34</option>
    <option value="35">35</option>
    <option value="36">36</option>
    <option value="37">37</option>
    <option value="38">38</option>
    <option value="39">39</option>
    <option value="40">40</option>
    <option value="41">41</option>
    <option value="42">42</option>
    <option value="43">43</option>
    <option value="44">44</option>
    <option value="45">45</option>
    <option value="46">46</option>
    <option value="47">47</option>
    <option value="48">48</option>
    <option value="49">49</option>
    <option value="50">50</option>
    <option value="51">51</option>
    <option value="52">52</option>
    <option value="53">53</option>
    <option value="54">54</option>
    <option value="55">55</option>
    <option value="56">56</option>
    <option value="57">57</option>
    <option value="58">58</option>
    <option value="59">59</option>
  </select>
  <br/> <br/>
  <input type="submit" value="Register" name="submitted" onclick="getInfo()" />
  <br />
  <span id="information"></span>
</fieldset>
<p> Already a customer ? <a href="login.html"><b>Login here</b></a></b>
  </a>
</p>

</html>

<script type="text/javascript">
  var xmlhttp = false;
  if (window.XMLHttpRequest)
    xmlhttp = new XMLHttpRequest();
  else if (window.ActiveXObject)
    xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");

  function getInfo() {
    console.log("in getInfo");
    var itemname = document.getElementById('itemname').value;
    var category = document.getElementById('category').value;
    var desc = document.getElementById('desc').value;
    var startprice = document.getElementById('startprice').value;
    var resprice = document.getElementById('resprice').value;
    var buyprice = document.getElementById('buyprice').value;
    var day = document.getElementById('day').value;
    var hour = document.getElementById('hour').value;
    var second = document.getElementById('minute').value;
    console.log("--" + itemname + "--" + category);
    if (itemname == "" || category == "" || desc == "") {
      alert("First name, Surname or email cannot be empty!");
    }
    else {
      console.log("in else" + itemname + "---" + category);
      retrieveInfo();
    }
  }

  function retrieveInfo() {
    //var params = "&user=" +  + "&pass=" ;
    console.log("in retrieveInfo");
    var priceCheck = priceValid();
    priceCheck = priceCheck.trim();
    if (priceCheck == "stfalse") {
      alert("Start Price cannot be greater than Reserve Price");
    }
    else if (priceCheck == "resfalse") {
      alert("Reserve Price Cannot be greater than Buy price");
    }
    else {
      console.log("preparing get request");
      xmlhttp.open("GET", "listing.php?itemname=" + document.getElementById('itemname').value + "&category=" + document.getElementById('category').value +
        "&desc=" + document.getElementById('desc').value + "&startprice=" + document.getElementById('startprice').value +
        "&resprice=" + document.getElementById('resprice').value + "&buyprice=" + document.getElementById('buyprice').value +
        "&day=" + document.getElementById('day').value + "&hour=" + document.getElementById('hour').value +
        "&minute=" + document.getElementById('minute').value, true);

      xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
      xmlhttp.onreadystatechange = function() {
        console.log("readystate changed");
        if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
          console.log(xmlhttp.responseText);
          document.getElementById("information").innerHTML = xmlhttp.responseText;
        }
      }
      xmlhttp.send(); // Actually execute the request
    }
  }

  function priceValid() {
    if (document.getElementById('startprice').value > document.getElementById('resprice').value) {
      return "stfalse";
    }
    else if (document.getElementById('resprice').value > document.getElementById('buyprice').value) {
      return "resfalse";
    }
    else {
      return "ok";
    }
  }
</script>